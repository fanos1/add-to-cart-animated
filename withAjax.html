<!doctype html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <title> Fresc Foods | Fresh Food </title>

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"/>

    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700'	rel='stylesheet' type='text/css' />
    <link href="/css/custom.css" rel="stylesheet" type="text/css" />
	
	<style type="text/css">
		select option:nth-child(odd) {
			color: #777;
		}       
		
		div#one { /* This is the image that will animate and go into the Basket. it seat on top of the other image */
			position: absolute;
			width: 260px;
			text-align: center;  
			top: 3px;    
		}		
	</style>

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>


</head>


<body>
 
	<div id="cart">
		<a href="/cart.php">
			<img src="/img/cart.png" width="90" height="94" alt="shopping cart" />
		</a>    
		<div id="display" style="opacity: 0; color: red; padding:5px;">Item Added</div>
	</div>


	
	<div class="container"> 
    
		<div class="row products">
				
                <div class="col-md-3" itemtype="http://schema.org/Product" itemscope="" style="position:relative; z-index:600;">                
                    <div id="one">
                        <img class="one" src="/img/gumulcine-kahvesi.png"  alt="Freshly roasted Turkish coffee" />
                    </div>
                        
                    <div class="thumbnail">                       
                        <img alt="Freshly roasted Turkish coffee" src="/img/gumulcine-kahvesi.png"  />
                        <div class="caption"> 
                            <div>Freshly roasted Turkish coffee</div>
                            <div><strong>Price:</strong> £6.00<br /></div>
                            <div>750gr</div>                                
                            <form action="/cart.php" method="get" class="myForm">                
                                <input type="hidden" name="action" value="add" />                   
                                <input type="hidden" name="product_id" value="3" />   
                                <input type="hidden" name="product_code" value="1" />   
                                <input type="hidden" name="size" value="3" />       
                                <input type="submit" value="Add to Cart"  />                
                            </form>
                        </div>	 
                    </div>                        	
                </div>
				
				
                <div class="col-md-3" itemtype="http://schema.org/Product" itemscope="" style="position:relative; z-index:500;">                
                    <div id="one">
                        <img class="one" src="/img/gumulcine-kahvesi.png"  alt="Gumilcine Turkish coffee" />
                    </div>
                        
                    <div class="thumbnail">                       
                        <img alt="Gumilcine Turkish coffee" src="/img/gumulcine-kahvesi.png"  />                        
                        <div class="caption"> 
                            <div>Gumilcine Turkish coffee</div>
                            <div><strong>Price:</strong> £8.00<br /></div>
                            <div>1000gr</div>                                
                            <form action="/cart.php" method="get" class="myForm">                
                                <input type="hidden" name="action" value="add" />                   
                                <input type="hidden" name="product_id" value="4" />   
                                <input type="hidden" name="product_code" value="1" />   
                                <input type="hidden" name="size" value="4" />                                      
                                <input type="submit" value="Add to Cart"  />                
                            </form>
                        </div>	 
                    </div>                        	
                </div>
				
                <div class="col-md-3" itemtype="http://schema.org/Product" itemscope="" style="position:relative; z-index:400;">
                
                    <div id="one"> <!-- image on top -->
                        <img class="one" src="/img/gumulcine-kahvesi.png"  alt="Fresh turkish coffee" />
                    </div>
                        
                    <div class="thumbnail">                       
                        <img alt="Fresh turkish coffee" src="/img/gumulcine-kahvesi.png"  />                        
                        <div class="caption"> 
                            <div>Fresh turkish coffee</div>
                            <div><strong>Price:</strong> £5.00<br /></div>
                            <div>500gr</div>                                
                            <form action="/cart.php" method="get" class="myForm">                
                                <input type="hidden" name="action" value="add" />                   
                                <input type="hidden" name="product_id" value="2" />   
                                <input type="hidden" name="product_code" value="1" />   
                                <input type="hidden" name="size" value="2" />                                      
                                <input type="submit" value="Add to Cart"  />                
                            </form>
                        </div>	 
                    </div>                        	
                </div>
				
                <div class="col-md-3" itemtype="http://schema.org/Product" itemscope="" style="position:relative; z-index:300;">
                
                    <div id="one"> <!-- image on top -->
                        <img class="one" src="/img/gumulcine-kahvesi.png"  alt="daily roasted Turkish coffee" />
                    </div>
                        
                    <div class="thumbnail">                       
                        <img alt="daily roasted Turkish coffee" src="/img/gumulcine-kahvesi.png"  />                        
                        <div class="caption"> 
                            <div>daily roasted Turkish coffee</div>
                            <div><strong>Price:</strong> £3.00<br /></div>
                            <div>250gr</div>                                
                            <form action="/cart.php" method="get" class="myForm">                
                                <input type="hidden" name="action" value="add" />                   
                                <input type="hidden" name="product_id" value="1" />   
                                <input type="hidden" name="product_code" value="1" />   
                                <input type="hidden" name="size" value="1" />                                      
                                <input type="submit" value="Add to Cart"  />                
                            </form>
                        </div>	 						
                    </div>                        						
                </div>    
				
		</div>
		
</div><!-- container --> 


 



    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>    	
	
    <script type="text/javascript">
    	$(document).ready( function () {

                CSSPlugin.defaultTransformPerspective = 800; 
                //transformOrigin:"center top" GIVES flipping down from the top EFFECT
                tl = new TimelineLite();
                tl.staggerFrom("div.products .col-md-3", 1, {opacity:0, x:-100, ease:Back.easeOut}, 0.2 );				  
 
                
                var cartElement = $("div#cart").offset();//Get the position of <idv id=cart> relative to documnetn
                
				
                $('.myForm').on('submit', function(e) { 
                
                    e.preventDefault(); //When form is submitted prevent it being sent
                    
                     var $currentForm = $(this);
                     // Let's select and cache all the fields
                     var $inputs = $currentForm.find("input, select, button, textarea");
                     var formData = $currentForm.serialize();
                     
                     //========== GREENSOCK ============
                     var formParents = $currentForm.parents();
                     
                     var thumbnail = $(formParents.parents()[1]);//Select <div classcol-md-3> and put it inside jQuery objct                                          
                     var currentImg = $(thumbnail.find('div#one') );  //find <span class=one> which is inside <div class=col-md-3>
                     var currentImgPos = $(currentImg).offset();//offset() gets postion relative to document
                     
                     
                    
                     // disable the inputs for the duration of the Ajax request.
                     // Note: we disable elements AFTER the form data has been serialized.
                     // Disabled form elements will not be serialized.
                     // $inputs.prop("disabled", true);

                     // Fire off the request to /form.php
                     request = $.ajax({
                         url: "/cart.php",
                         type: "get",
                         data: formData
                     });

                     request.done( function(response, textStatus, jqXHR) {

                         var parsedRespon = jQuery.parseJSON( response ); 

                         if(parsedRespon.status == 'success') {            
                            
                            TweenMax.from("div#cart", 1, {yPercent:20,  ease:RoughEase.ease.config({strength:3, points:10})} );                            
							
                            var destinationLeft = cartElement.left - currentImgPos.left;
                            var destinationTop = cartElement.top - currentImgPos.top;
                            
                            //currentImg.css("z-index", "9999999");//Set z-index of current image so it will move on top of the bottom images

                            function myFunction() {
                                tl.set(currentImg, {clearProps:"all"}); //clear top and left: properties, otherwise next time user clicks, the 2nd image will not be on top of the other
                            }

                            tl = new TimelineLite({onComplete:myFunction});
                            tl.to( currentImg, 3, {scale:0.3, autoAlpha:0, bezier: [{left:10, top:-30}, {left:0, top:0}, {left:destinationLeft-40, top:destinationTop-10}], ease:Power1.easeInOut} );
                            
                         } else if (parsedRespon.status == 'error') {
                             //alert('error');                             
                         }

                     });
                
                    // Callback handler that will be called on failure
                    request.fail( function(jqXHR, textStatus, errorThrown) {                         
                        //alert('failed, We apologize! ');                        
                    });

                    /* 
                    // Callback handler that will be called regardless if the request failed or succeeded
                    request.always(function () {
                        // Reenable the inputs
                        $inputs.prop("disabled", false);
                    }); 
                    */
                
                
            });//End on(submit)
            
                    
        }); //End Ready
        
      
    </script>
    

</body>
</html>
